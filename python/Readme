# ğŸ  Real Estate Search API

Backend API à¸ªà¸³à¸«à¸£à¸±à¸šà¸£à¸°à¸šà¸šà¸„à¹‰à¸™à¸«à¸²à¸—à¸£à¸±à¸à¸¢à¹Œà¸ªà¸´à¸™à¸­à¸ªà¸±à¸‡à¸«à¸²à¸£à¸´à¸¡à¸—à¸£à¸±à¸à¸¢à¹Œ à¸à¸£à¹‰à¸­à¸¡ AI-powered search, user authentication à¹à¸¥à¸°à¸£à¸°à¸šà¸š favorites

## âœ¨ Features

- ğŸ” **Hybrid Search** - Vector search + Keyword search + Filters
- ğŸ¤– **AI Reranking** - à¹ƒà¸Šà¹‰ Google Gemini 2.5 Flash à¸ˆà¸±à¸”à¸­à¸±à¸™à¸”à¸±à¸šà¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ
- ğŸ‘¤ **User Authentication** - JWT-based authentication
- â¤ï¸ **Favorites System** - à¸šà¸±à¸™à¸—à¸¶à¸à¸—à¸£à¸±à¸à¸¢à¹Œà¸ªà¸´à¸™à¸—à¸µà¹ˆà¸Šà¸­à¸š
- ğŸ“Š **Search History** - à¸šà¸±à¸™à¸—à¸¶à¸à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸à¸²à¸£à¸„à¹‰à¸™à¸«à¸² (20 à¸£à¸²à¸¢à¸à¸²à¸£)
- ğŸ¯ **Personalized Recommendations** - à¹à¸™à¸°à¸™à¸³à¸—à¸£à¸±à¸à¸¢à¹Œà¸ªà¸´à¸™à¸•à¸²à¸¡à¸„à¸§à¸²à¸¡à¸ªà¸™à¹ƒà¸ˆ
- ğŸ—ºï¸ **Geospatial Data** - à¸à¸´à¸à¸±à¸”à¹à¸¥à¸°à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸•à¸±à¹‰à¸‡

## ğŸ› ï¸ Tech Stack

- **Framework**: FastAPI
- **Database**: MongoDB (with vector search)
- **AI**: Google Gemini API
- **Authentication**: JWT (python-jose)
- **Password Hashing**: bcrypt
- **Async Driver**: Motor (async MongoDB driver)

## ğŸ“‹ Prerequisites

- Python 3.10+
- MongoDB 7.0+ (with Atlas Vector Search)
- Google Gemini API Key

## ğŸš€ Installation

### 1. Clone the repository

```bash
git clone <repository-url>
cd python
```

### 2. Create virtual environment

```bash
# Create venv
python -m venv venv

# Activate (Windows)
venv\Scripts\activate

# Activate (Mac/Linux)
source venv/bin/activate
```

### 3. Install dependencies

```bash
pip install -r requirements.txt
```

### 4. Setup environment variables

```bash
# Copy .env.example to .env
cp .env.example .env

# Edit .env and add your credentials
notepad .env  # Windows
nano .env     # Mac/Linux
```

Required environment variables:
```env
MONGO_URI=mongodb://localhost:27017
GEMINI_API_KEY=your_gemini_api_key
JWT_SECRET=your_secret_key
```

### 5. Start MongoDB

```bash
# Windows
net start MongoDB

# Mac (Homebrew)
brew services start mongodb-community

# Linux
sudo systemctl start mongod

# Docker
docker run -d -p 27017:27017 --name mongodb mongo:7.0
```

### 6. Run the server

```bash
python main.py
```

Server will start at: `http://localhost:8000`

## ğŸ“š API Documentation

### Interactive API Docs

- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

### API Endpoints

#### Authentication
- `POST /api/auth/register` - à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸
- `POST /api/auth/login` - à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š

#### Property Search
- `GET /hybrid_search` - à¸„à¹‰à¸™à¸«à¸²à¸—à¸£à¸±à¸à¸¢à¹Œà¸ªà¸´à¸™ (hybrid search)
- `GET /property/{id}` - à¸”à¸¹à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸—à¸£à¸±à¸à¸¢à¹Œà¸ªà¸´à¸™
- `POST /recommendations` - à¹à¸™à¸°à¸™à¸³à¸—à¸£à¸±à¸à¸¢à¹Œà¸ªà¸´à¸™à¸•à¸²à¸¡à¸„à¸§à¸²à¸¡à¸ªà¸™à¹ƒà¸ˆ

#### Search History
- `POST /api/search/save` - à¸šà¸±à¸™à¸—à¸¶à¸à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸„à¹‰à¸™à¸«à¸² (à¸ªà¸¡à¸²à¸Šà¸´à¸)
- `POST /api/search/guest` - à¸šà¸±à¸™à¸—à¸¶à¸à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸„à¹‰à¸™à¸«à¸² (Guest)

#### Favorites
- `POST /api/favorites/add` - à¹€à¸à¸´à¹ˆà¸¡à¸£à¸²à¸¢à¸à¸²à¸£à¹‚à¸›à¸£à¸”
- `POST /api/favorites/remove` - à¸¥à¸šà¸£à¸²à¸¢à¸à¸²à¸£à¹‚à¸›à¸£à¸”
- `GET /api/favorites/list` - à¸”à¸¹à¸£à¸²à¸¢à¸à¸²à¸£à¹‚à¸›à¸£à¸”à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
- `GET /api/favorites/check/{propertyId}` - à¹€à¸Šà¹‡à¸„à¸§à¹ˆà¸²à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸£à¸²à¸¢à¸à¸²à¸£à¹‚à¸›à¸£à¸”à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ

## ğŸ§ª Testing

### Test with curl

```bash
# Register
curl -X POST "http://localhost:8000/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"12345678","name":"Test User"}'

# Login
curl -X POST "http://localhost:8000/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"12345678"}'

# Search
curl "http://localhost:8000/hybrid_search?query=à¸„à¸­à¸™à¹‚à¸”+à¸šà¸²à¸‡à¸™à¸²&min_price=2000000&max_price=5000000"
```

## ğŸ“ Project Structure

```
python/
â”œâ”€â”€ main.py                 # Main FastAPI application
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ auth_routes.py     # Authentication endpoints
â”‚   â”œâ”€â”€ search_routes.py   # Search history endpoints
â”‚   â”œâ”€â”€ favorite_routes.py # Favorites endpoints
â”‚   â””â”€â”€ property_routes.py # Property search endpoints
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ auth_middleware.py # JWT authentication middleware
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ auth.py            # Password hashing utilities
â”‚   â””â”€â”€ validators.py      # Input validation
â”œâ”€â”€ requirements.txt       # Python dependencies
â”œâ”€â”€ .env.example          # Environment variables template
â”œâ”€â”€ .gitignore            # Git ignore rules
â””â”€â”€ README.md             # This file
```

## ğŸ› Troubleshooting

### MongoDB Connection Error

```
Error: pymongo.errors.ServerSelectionTimeoutError
```

**Solution**: Make sure MongoDB is running
```bash
mongosh --eval "db.version()"
```

### bcrypt Import Error

```
Error: cannot import name '_bcrypt'
```

**Solution**: Reinstall bcrypt
```bash
pip uninstall bcrypt passlib -y
pip install bcrypt==4.0.1 passlib==1.7.4
```

---

Made with â¤ï¸ for Real Estate Search